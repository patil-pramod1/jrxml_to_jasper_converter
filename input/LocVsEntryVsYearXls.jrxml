<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="LocVsEntryVsYearXls" language="groovy" pageWidth="842" pageHeight="595" orientation="Landscape" columnWidth="802" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" isSummaryWithPageHeaderAndFooter="true" isIgnorePagination="true" uuid="0f9dfc0b-53b8-4eba-aa49-32aa6f8b9321">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	
    <property name="net.sf.jasperreports.export.xls.remove.empty.space.between.rows" value="true"/>
    <property name="net.sf.jasperreports.export.xls.remove.empty.space.between.columns" value="true"/>
    <property name="net.sf.jasperreports.export.xls.white.page.background" value="false"/>
    <property name="net.sf.jasperreports.export.xls.detect.cell.type" value="true"/>
    <property name="net.sf.jasperreports.export.xls.sheet.names.all" value="trait"/>
    <property name="net.sf.jasperreports.export.xls.freeze.row" value="2"/>
	<style name="Crosstab Data Text" hAlign="Center"/>
	<parameter name="cropName" class="java.lang.String"/>
	<parameter name="trait" class="java.lang.String"/>
	<parameter name="trailType" class="java.lang.String"/>
	<parameter name="location" class="java.lang.String"/>
	<parameter name="hybridList" class="java.lang.String"/>
	<parameter name="experimentList" class="java.lang.String"/>
	<parameter name="ReportName" class="java.lang.String"/>
	<queryString>
		<![CDATA[]]>
	</queryString>
	<field name="experimentYear" class="java.lang.String">
		<fieldDescription><![CDATA[experimentYear]]></fieldDescription>
	</field>
	<field name="hybridNumber" class="java.lang.String">
		<fieldDescription><![CDATA[hybridNumber]]></fieldDescription>
	</field>
	<field name="locationCode" class="java.lang.String">
		<fieldDescription><![CDATA[locationCode]]></fieldDescription>
	</field>
	<field name="triatMeanValue" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[triatMeanValue]]></fieldDescription>
	</field>

    <variable name="sheetTotal" class="java.math.BigDecimal" calculation="Sum">
        <variableExpression><![CDATA[$F{triatMeanValue}]]></variableExpression>
    </variable>

	<background>
		<band splitType="Stretch"/>
	</background>

	<title>
        <band height="30">
            <textField>
                <reportElement x="0" y="0" width="802" height="30" uuid="1c86dce1-b3e9-4031-901b-8b7c5601f87c"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font size="14" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA["Location vs Entry vs Year Report - " + $P{trait}]]></textFieldExpression>
            </textField>
        </band>
    </title>
	<summary>
		<band height="400" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="41" width="82" height="21" uuid="bfe70bd9-2631-40e3-af8e-68f012eb93b3"/>
				<box>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="11" isBold="true"/>
					<paragraph rightIndent="4"/>
				</textElement>
				<text><![CDATA[Crop:]]></text>
			</staticText>
			<staticText>
				<reportElement x="502" y="41" width="147" height="21" uuid="d66c5c29-ffd1-4d1f-91e1-658d1acc59c0"/>
				<box>
					<topPen lineWidth="0.0"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="11" isBold="true"/>
					<paragraph rightIndent="4"/>
				</textElement>
				<text><![CDATA[Trial:]]></text>
			</staticText>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement x="82" y="41" width="126" height="21" uuid="d58fef2a-97a4-4add-8dcf-8d22410ca7c3"/>
				<box>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="10" isBold="false"/>
					<paragraph leftIndent="4"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{cropName}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement x="649" y="41" width="147" height="21" uuid="c48c14e5-56b1-48b8-9f0e-918113adbc50"/>
				<box>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="10" isBold="false"/>
					<paragraph leftIndent="4"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{trailType}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="208" y="41" width="147" height="21" uuid="0b826d74-dbba-48fc-b9c1-daa73eb8d1dc"/>
				<box>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="11" isBold="true"/>
					<paragraph rightIndent="4"/>
				</textElement>
				<text><![CDATA[Trait:]]></text>
			</staticText>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement x="355" y="41" width="147" height="21" uuid="d67803f7-4add-4973-b1e5-12f4a8aad960"/>
				<box>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font size="10"/>
					<paragraph leftIndent="4"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{trait}]]></textFieldExpression>
			</textField>
			<crosstab isRepeatColumnHeaders="false" isRepeatRowHeaders="false" columnBreakOffset="500" ignoreWidth="true">
				<reportElement positionType="Float" x="0" y="122" width="802" height="156" uuid="c282ed1b-0047-4ca9-9904-0e59ab634af9"/>
				<crosstabDataset isDataPreSorted="true">
                    <dataset>
                        <incrementWhenExpression><![CDATA[true]]></incrementWhenExpression>
                    </dataset>
                </crosstabDataset>
				<crosstabHeaderCell>
					<cellContents backcolor="#99CC00" mode="Opaque">
						<staticText>
							<reportElement style="Crosstab Data Text" x="0" y="0" width="82" height="30" uuid="967d7550-2c67-440e-abc1-b6777daa9371"/>
							<box>
								<topPen lineWidth="0.5"/>
								<leftPen lineWidth="0.5"/>
								<bottomPen lineWidth="0.5"/>
								<rightPen lineWidth="0.5"/>
							</box>
							<textElement verticalAlignment="Middle"/>
							<text><![CDATA[Year]]></text>
						</staticText>
						<staticText>
							<reportElement style="Crosstab Data Text" x="82" y="0" width="126" height="30" uuid="3694f35a-652c-4df9-b1b3-3efddfd40c4d"/>
							<box>
								<topPen lineWidth="0.5"/>
								<leftPen lineWidth="0.5"/>
								<bottomPen lineWidth="0.5"/>
								<rightPen lineWidth="0.5"/>
							</box>
							<textElement verticalAlignment="Middle"/>
							<text><![CDATA[HybridNo]]></text>
						</staticText>
					</cellContents>
				</crosstabHeaderCell>
				<rowGroup name="experimentYear" width="82">
					<bucket class="java.lang.String">
						<bucketExpression><![CDATA[$F{experimentYear}]]></bucketExpression>
					</bucket>
					<crosstabRowHeader>
						<cellContents backcolor="#F0F8FF" mode="Opaque">
							<box>
								<pen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
							</box>
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement style="Crosstab Data Text" x="0" y="0" width="82" height="25" uuid="fb44b564-820c-4b9f-b9a6-e0bbd5e71fee"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$V{experimentYear}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabRowHeader>
					<crosstabTotalRowHeader>
						<cellContents backcolor="#BFE1FF" mode="Opaque">
                            <box>
                                <pen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
                            </box>
                            <staticText>
                                <reportElement style="Crosstab Data Text" x="0" y="0" width="208" height="25" uuid="9ef460a3-4bdf-4604-9199-1e0f6c7309ca"/>
                                <textElement verticalAlignment="Middle"/>
                                <text><![CDATA[Total]]></text>
                            </staticText>
                        </cellContents>
					</crosstabTotalRowHeader>
				</rowGroup>
				<rowGroup name="hybridNumber" width="126">
					<bucket class="java.lang.String">
						<bucketExpression><![CDATA[$F{hybridNumber}]]></bucketExpression>
					</bucket>
					<crosstabRowHeader>
						<cellContents backcolor="#F0F8FF" mode="Opaque">
							<box>
								<pen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
							</box>
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement style="Crosstab Data Text" x="0" y="0" width="126" height="25" uuid="92c4c89c-6e9a-4366-8432-87f7a3c141be"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$V{hybridNumber}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabRowHeader>
					<crosstabTotalRowHeader>
						<cellContents backcolor="#BFE1FF" mode="Opaque">
                            <box>
                                <pen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
                            </box>
                            <staticText>
                                <reportElement style="Crosstab Data Text" x="0" y="0" width="126" height="25" uuid="07dbc29d-9cac-4c63-9b87-9886d7defcc5"/>
                                <textElement verticalAlignment="Middle"/>
                                <text><![CDATA[Total]]></text>
                            </staticText>
                        </cellContents>
					</crosstabTotalRowHeader>
				</rowGroup>
				<columnGroup name="locationCode" height="30" totalPosition="End">
					<bucket class="java.lang.String">
						<bucketExpression><![CDATA[$F{locationCode}]]></bucketExpression>
					</bucket>
					<crosstabColumnHeader>
						<cellContents backcolor="#99CC00" mode="Opaque">
							<box>
								<pen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
							</box>
							<textField>
								<reportElement style="Crosstab Data Text" x="0" y="0" width="147" height="30" uuid="9210f0c5-9ac9-44d2-bfa3-ed44a8839c5c"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$V{locationCode}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabColumnHeader>
					<crosstabTotalColumnHeader>
						<cellContents backcolor="#99CC00" mode="Opaque">
							<box>
								<pen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
							</box>
							<staticText>
								<reportElement x="0" y="0" width="147" height="30" uuid="03a4228d-3f9f-4d01-afc7-d17125ed8f3a"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<text><![CDATA[Mean]]></text>
							</staticText>
						</cellContents>
					</crosstabTotalColumnHeader>
				</columnGroup>
				<measure name="triatMeanValueMeasure" class="java.math.BigDecimal" calculation="Average">
					<measureExpression><![CDATA[$F{triatMeanValue}]]></measureExpression>
				</measure>
				<crosstabCell width="147" height="25">
					<cellContents>
						<box>
							<pen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
						</box>
						<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
							<reportElement style="Crosstab Data Text" x="0" y="0" width="147" height="25" uuid="341012a4-bde6-4402-bea7-9956a220b008"/>
							<textElement verticalAlignment="Middle"/>
							<textFieldExpression><![CDATA[$V{triatMeanValueMeasure}.equals( new BigDecimal(0.000))?"":$V{triatMeanValueMeasure}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
				<crosstabCell width="147" height="25" rowTotalGroup="experimentYear">
					<cellContents backcolor="#BFE1FF" mode="Opaque">
						<box>
							<pen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
						</box>
						<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
							<reportElement style="Crosstab Data Text" x="0" y="0" width="147" height="25" uuid="d8cc8302-6b84-44ac-b74d-3ceff40ee204"/>
							<textElement verticalAlignment="Middle"/>
							<textFieldExpression><![CDATA[$V{triatMeanValueMeasure}.equals( new BigDecimal(0.000))?"":$V{triatMeanValueMeasure}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
				<crosstabCell width="147" height="25" columnTotalGroup="locationCode">
					<cellContents backcolor="#BFE1FF" mode="Opaque">
						<box>
							<pen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
						</box>
						<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
							<reportElement style="Crosstab Data Text" x="0" y="0" width="147" height="25" uuid="641ab850-761f-443f-97b5-348b2138c453"/>
							<textElement verticalAlignment="Middle"/>
							<textFieldExpression><![CDATA[$V{triatMeanValueMeasure}.equals( new BigDecimal(0.000))?"":$V{triatMeanValueMeasure}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
				<crosstabCell width="147" height="25" rowTotalGroup="experimentYear" columnTotalGroup="locationCode">
					<cellContents backcolor="#005FB3" mode="Opaque">
						<box>
							<pen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
						</box>
						<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
							<reportElement style="Crosstab Data Text" x="0" y="0" width="147" height="25" forecolor="#FFFFFF" uuid="cbfb124a-94ee-42ed-a16c-1703aef26849"/>
							<textElement verticalAlignment="Middle"/>
							<textFieldExpression><![CDATA[$V{triatMeanValueMeasure}.equals( new BigDecimal(0.000))?"":$V{triatMeanValueMeasure}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
				<crosstabCell width="147" height="25" rowTotalGroup="hybridNumber">
					<cellContents backcolor="#BFE1FF" mode="Opaque">
						<box>
							<pen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
						</box>
						<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
							<reportElement style="Crosstab Data Text" x="0" y="0" width="147" height="25" uuid="56bad302-d76e-479e-9343-3bee799c1cef"/>
							<textElement verticalAlignment="Middle"/>
							<textFieldExpression><![CDATA[$V{triatMeanValueMeasure}.equals( new BigDecimal(0.000))?"":$V{triatMeanValueMeasure}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
				<crosstabCell width="147" height="25" rowTotalGroup="hybridNumber" columnTotalGroup="locationCode">
					<cellContents backcolor="#BFE1FF" mode="Opaque">
						<box>
							<pen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
						</box>
						<textField isStretchWithOverflow="true" pattern="###0.00" isBlankWhenNull="true">
							<reportElement style="Crosstab Data Text" x="0" y="0" width="147" height="25" uuid="07dbc29d-9cac-4c63-9b87-9886d7defcc5"/>
							<textElement verticalAlignment="Middle"/>
							<textFieldExpression><![CDATA[$V{triatMeanValueMeasure}.equals( new BigDecimal(0.000))?"":$V{triatMeanValueMeasure}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
			</crosstab>
			<staticText>
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="0" y="62" width="82" height="24" uuid="fed2b5a2-2a72-4179-8bae-5e93728c15a5"/>
				<box>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="11" isBold="true"/>
					<paragraph rightIndent="4"/>
				</textElement>
				<text><![CDATA[Hybrid No:]]></text>
			</staticText>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="82" y="62" width="126" height="24" uuid="946555b3-3716-44b7-b97d-fbec53edccd0"/>
				<box>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement verticalAlignment="Middle">
					<paragraph leftIndent="4"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{hybridList}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="208" y="62" width="147" height="24" uuid="02a5b808-c94f-4557-b5fb-985887dca2d8"/>
				<box>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="11" isBold="true"/>
					<paragraph rightIndent="4"/>
				</textElement>
				<text><![CDATA[Experiment Id:]]></text>
			</staticText>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="355" y="62" width="147" height="24" uuid="bfffa3c4-d9b8-465b-ac43-403176b83d46"/>
				<box>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement verticalAlignment="Middle">
					<paragraph leftIndent="2"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{experimentList}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="502" y="62" width="147" height="24" uuid="1a436c6e-e757-4a42-b97d-678bef1a3d9a"/>
				<box>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="11" isBold="true"/>
					<paragraph rightIndent="4"/>
				</textElement>
				<text><![CDATA[Location:]]></text>
			</staticText>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement positionType="Float" stretchType="RelativeToBandHeight" x="649" y="62" width="147" height="24" uuid="aab9950b-a3db-4bf1-b03e-409a3a7f4bbf"/>
				<box>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement verticalAlignment="Middle">
					<paragraph leftIndent="4"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{location}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement mode="Opaque" x="0" y="21" width="796" height="20" backcolor="#99CC00" uuid="9ef460a3-4bdf-4604-9199-1e0f6c7309ca"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="11" isBold="true"/>
				</textElement>
				<text><![CDATA[Location Vs Entry Vs Year]]></text>
			</staticText>

			<!-- Add sheet footer -->
            <textField>
                <reportElement positionType="Float" x="0" y="380" width="802" height="20" uuid="62e56a87-bcc3-4546-a778-9b754a7f12c5"/>
                <textElement textAlignment="Right">
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA["Trait: " + $P{trait} + " - Page " + $V{PAGE_NUMBER}]]></textFieldExpression>
            </textField>
		</band>
	</summary>
</jasperReport>